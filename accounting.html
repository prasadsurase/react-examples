<!DOCTYPE html>
<html>
  <head>
    <meta charset='UTF-8' />
    <title>Acconting</title>
    <script src='build/react.js'></script>
    <script src='build/react-dom.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js'></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" >
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" ></script>
  </head>
  <body>
    <div id='container'></div>
    <script type='text/babel'>
      var TransactionsSummary = React.createClass({
        render: function(){
          return(
            <ul>
              <li>Transactions: 2</li>
              <li>Debits: 500</li>
              <li>Credits: 600</li>
              <li>Balance: 100</li>
              <li>Total: 1100</li>
            </ul>
          );
        }
      });

      var TransactionForm = React.createClass({
        getInitialState: function(){
          return { date: '', reason: '', amount: '' };
        },

        handleChange: function(e){
          switch(e.target.name){
            case 'date':
              this.setState({date: e.target.value});
              break;
            case 'reason':
              this.setState({reason: e.target.value});
              break;
            case 'amount':
              this.setState({amount: e.target.value});
              break;
          }
        },

        handleSubmit: function(e){
          e.preventDefault();
          this.props.handleNewRecord(this.state);
          this.setState(this.getInitialState());
        },

        render: function(){
          return (
            <form onSubmit={this.handleSubmit}>
              Date: <input type='text' name='date' value={this.state.date} onChange={this.handleChange}/><br />
              Reason: <input type='text' name='reason' value={this.state.reason} onChange={this.handleChange}/><br />
              Amount: <input type='integer' name='amount' value={this.state.amount} onChange={this.handleChange}/><br />
              <button type='submit'>Submit</button>
              <button type='button'>Cancel</button>
            </form>
          );
        }
      });

      var TransactionRow = React.createClass({
        render: function(){
          return (
            <tr>
              <td>{this.props.record.date}</td>
              <td>{this.props.record.reason}</td>
              <td>{this.props.record.amount}</td>
            </tr>
          );
        }
      });

      var TransactionsTable = React.createClass({
        render: function(){
          var rows = [];
          this.props.records.map(function(record, index){
            rows.push(<TransactionRow key={index} record={record} />);
          }.bind(this));
          return (
            <table>
              <thead>
                <tr>
                  <th> Date </th>
                  <th> Reason </th>
                  <th> Amount </th>
                </tr>
              </thead>
              <tbody>
                { rows }
              </tbody>
            </table>
          );
        }
      });

      var TransactionsDetails = React.createClass({
        getInitialState: function(){
          return { records: [] };
        },

        addRecord: function(record){
          var records = this.state.records;
          records.push(record);
          this.setState({ records: records });
        },

        render: function(){
          return (
            <div className="container">
              <div className='row'>
                <div className="col-md-3">
                  <TransactionsSummary />
                </div>
                <div className="col-md-3">
                  <TransactionForm handleNewRecord={this.addRecord}/>
                </div>
              </div>
              <div className='row'>
                <div className="col-md-6">
                  <TransactionsTable records={this.state.records}/>
                </div>
              </div>
            </div>
          );
        }
      });

      ReactDOM.render( <TransactionsDetails />, document.getElementById('container'));
    </script>
  </body>
</html>
